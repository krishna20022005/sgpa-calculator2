<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SGPA Calculator</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #1a1a1a; /* Dark background */
            color: #f0f0f0; /* Light text */
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column; /* Changed to column to accommodate footer */
            justify-content: flex-start; /* Align items at the start */
            align-items: center;
            min-height: 100vh;
            box-sizing: border-box;
        }

        .container {
            background-color: #2a2a2a; /* Slightly lighter dark background for container */
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.4);
            width: 100%;
            max-width: 800px;
            box-sizing: border-box;
            margin-bottom: 20px; /* Add some space below the main container */
        }

        h1 {
            color: #ff8c00; /* Orange highlight */
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.2em;
            letter-spacing: 1px;
        }

        .selection-section, .subject-entry-section {
            background-color: #333333;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 25px;
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.3);
        }

        .input-group {
            margin-bottom: 15px;
            display: flex;
            flex-direction: column;
        }

        .input-group label {
            margin-bottom: 8px;
            color: #cccccc;
            font-size: 1.1em;
        }

        .input-group select,
        .input-group input {
            width: calc(100% - 20px);
            padding: 12px;
            border: 1px solid #555;
            border-radius: 6px;
            background-color: #444;
            color: #f0f0f0;
            font-size: 1em;
            transition: border-color 0.3s, box-shadow 0.3s;
            box-sizing: border-box;
        }

        .input-group select:focus,
        .input-group input:focus {
            border-color: #ff8c00;
            box-shadow: 0 0 0 3px rgba(255, 140, 0, 0.3);
            outline: none;
        }

        .input-group input::-webkit-inner-spin-button,
        .input-group input::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        .input-group input {
            -moz-appearance: textfield; /* Firefox */
        }

        .subjects-container {
            padding: 20px;
            background-color: #333333;
            border-radius: 8px;
            margin-bottom: 25px;
            min-height: 100px; /* Placeholder height */
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .placeholder-text {
            color: #999;
            text-align: center;
            font-style: italic;
            padding: 30px 0;
        }

        .subject-section h3 {
            color: #ff8c00;
            margin-top: 0;
            margin-bottom: 15px;
            border-bottom: 2px solid #555;
            padding-bottom: 5px;
        }

        .subject-item {
            display: flex;
            flex-wrap: wrap; /* Allow wrapping on smaller screens */
            align-items: center;
            justify-content: space-between;
            background-color: #444;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 10px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .subject-details {
            flex: 2; /* Takes more space for name and credit */
            margin-right: 15px;
            min-width: 200px; /* Ensure it doesn't get too small */
        }

        .subject-details .name {
            font-weight: bold;
            color: #f0f0f0;
        }

        .subject-details .credit {
            font-size: 0.9em;
            color: #bbb;
        }

        .marks-input {
            flex: 1; /* Takes remaining space for inputs */
            display: flex;
            gap: 10px;
            min-width: 180px; /* Ensure inputs have enough space */
        }

        .marks-input input {
            flex: 1;
            text-align: center;
        }

        .btn {
            background-color: #ff8c00; /* Orange button */
            color: white;
            padding: 14px 25px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: bold;
            transition: background-color 0.3s, transform 0.2s;
            width: 100%;
            margin-bottom: 15px;
            box-sizing: border-box;
        }

        .btn:hover {
            background-color: #e67e00; /* Darker orange on hover */
            transform: translateY(-2px);
        }

        .btn:disabled {
            background-color: #555;
            cursor: not-allowed;
            opacity: 0.7;
            transform: none;
        }

        .result-container {
            background-color: #333333;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            font-size: 1.5em;
            font-weight: bold;
            color: #ff8c00;
            margin-top: 20px;
            min-height: 50px;
            display: flex;
            justify-content: center;
            align-items: center;
            box-sizing: border-box;
        }

        footer {
            text-align: center;
            padding: 10px 0;
            color: #999;
            font-size: 0.9em;
            margin-top: 20px;
        }

        @media (max-width: 600px) {
            .container {
                padding: 20px;
            }
            h1 {
                font-size: 1.8em;
            }
            .subject-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            .subject-details {
                margin-right: 0;
                min-width: unset;
                width: 100%;
            }
            .marks-input {
                width: 100%;
                min-width: unset;
            }
            .btn {
                padding: 12px 20px;
                font-size: 1em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>SGPA Calculator</h1>

        <div class="selection-section">
            <div class="input-group">
                <label for="branchSelect">Select Branch:</label>
                <select id="branchSelect">
                    <option value="">-- Select Branch --</option>
                    <option value="Mechanical Engineering">Mechanical Engineering</option>
                    <option value="CSE Core">CSE Core</option>
                    <option value="Civil Engineering">Civil Engineering</option>
                    <option value="Chemical Engineering">Chemical Engineering</option>
                    <option value="Electrical & Electronics Engineering">Electrical & Electronics Engineering</option>
                </select>
            </div>

            <div class="input-group">
                <label for="semesterSelect">Select Semester:</label>
                <select id="semesterSelect" disabled>
                    <option value="">-- Select Semester --</option>
                </select>
            </div>
        </div>

        <div id="subjectsContainer" class="subjects-container">
            <p class="placeholder-text">Please select your Branch and Semester to load subjects.</p>
        </div>

        <button id="calculateSGPABtn" class="btn" disabled>Calculate SGPA</button>
        <button id="downloadPdfBtn" class="btn" disabled>Download as PDF</button>

        <div id="resultContainer" class="result-container">
            </div>
    </div>

    <footer>
        Developed by **Krishna Raj** (Batch: 2023-27), Rashtrakavi Ramdhari Singh Dinkar College of Engineering, Branch: Mechanical Engineering.
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <script>
        const subjectsData = {
            "Mechanical Engineering": {
                "1st Semester": [
                    { code: "100101", name: "Engineering Chemistry", credit: 3, type: "theory" },
                    { code: "100102", name: "Engineering Mathematics-I", credit: 4, type: "theory" },
                    { code: "100103", name: "Communicative English", credit: 3, type: "theory" },
                    { code: "100104", name: "Engineering Graphics and Design", credit: 1, type: "theory" },
                    { code: "100106", name: "Basic Electrical Engineering", credit: 3, type: "theory" },
                    { code: "100109P", name: "Sports/Yoga/NCC/NSS", credit: 1, type: "practical" },
                    { code: "100101P", name: "Engineering Chemistry Lab", credit: 1, type: "practical" },
                    { code: "100103P", name: "Communicative English Lab", credit: 1, type: "practical" },
                    { code: "100104P", name: "Engineering Graphics and Design Lab", credit: 2, type: "practical" },
                    { code: "100106P", name: "Basic Electrical Engineering Lab", credit: 1, type: "practical" }
                ],
                "2nd Semester": [
                    { code: "100201", name: "Engineering Physics", credit: 3, type: "theory" },
                    { code: "100202", name: "Engineering Mathematics-II", credit: 4, type: "theory" },
                    { code: "100203", name: "Programming for Problem Solving", credit: 3, type: "theory" },
                    { code: "100214P", name: "Swachha Bharat Mission", credit: 1, type: "practical" },
                    { code: "100206", name: "Workshop Practices", credit: 2, type: "theory" },
                    { code: "100204", name: "Elements of Mechanical Engineering", credit: 3, type: "theory" },
                    { code: "100201P", name: "Engineering Physics Lab", credit: 1, type: "practical" },
                    { code: "100203P", name: "Programming for Problem Solving Lab", credit: 1, type: "practical" },
                    { code: "100206P", name: "Workshop Practices Lab", credit: 1, type: "practical" },
                    { code: "100204P", name: "Elements of Mechanical Engineering Lab", credit: 1, type: "practical" }
                ],
                "3rd Semester": [
                    { code: "100301", name: "BIOLOGY FOR ENGINEERS", credit: 3, type: "theory" },
                    { code: "100303", name: "BASIC ELECTRONICS ENGINEERING", credit: 4, type: "theory" },
                    { code: "100309", name: "ENGINEERING MECHANICS", credit: 3, type: "theory" },
                    { code: "100312", name: "MATHEMATICS-III (PDE, PROBABILILTY AND STATISTICS)", credit: 4, type: "theory" },
                    { code: "102304", name: "THERMODYNAMICS", credit: 4, type: "theory" },
                    { code: "100309P", name: "ENGINEERING MECHANICS", credit: 1, type: "practical" },
                    { code: "100399", name: "Internship", credit: 4, type: "special_100" },
                    { code: "102302P", name: "Machine Drawing", credit: 2, type: "practical" }
                ],
                "4th Semester": [
                    { code: "102401", name: "Applied Thermodynamics", credit: 4, type: "theory" },
                    { code: "102402", name: "Engineering Materials", credit: 4, type: "theory" },
                    { code: "102403", name: "Fluid Mechanics", credit: 3, type: "theory" },
                    { code: "102404", name: "Instrumentation & Control", credit: 4, type: "theory" },
                    { code: "102405", name: "Strength of Materials", credit: 3, type: "theory" },
                    { code: "100408", name: "MOOCs / SWAYAM / NPTEL Courses - 1", credit: 2, type: "special_100" },
                    { code: "102403P", name: "Fluid Mechanics LAB", credit: 1.50, type: "practical" },
                    { code: "102405P", name: "Strength of Materials LAB", credit: 1.50, type: "practical" }
                ],
                "5th Semester": [
                    { code: "102501", name: "Fluid Machinery", credit: 3, type: "theory" },
                    { code: "102502", name: "Heat Transfer", credit: 3, type: "theory" },
                    { code: "102503", name: "Kinematics of Machine", credit: 4, type: "theory" },
                    { code: "102504", name: "Manufacturing Processes", credit: 3, type: "theory" },
                    { code: "100510", name: "Summer Entrepreneurship – II", credit: 6, type: "special_100" },
                    { code: "100511", name: "MOOCs / SWAYAM / NPTEL Courses – 2", credit: 2, type: "special_100" },
                    { code: "102501P", name: "Fluid Machinery", credit: 1.50, type: "practical" },
                    { code: "102502P", name: "Heat Transfer", credit: 1.50, type: "practical" },
                    { code: "102504P", name: "Manufacturing Processes", credit: 1.50, type: "practical" }
                ]
            },
            "CSE Core": {
                "1st Semester": [
                    { code: "100110", name: "Engineering Physics", credit: 3, type: "theory" },
                    { code: "100102", name: "Engineering Mathematics-I", credit: 4, type: "theory" },
                    { code: "100111", name: "Programming for Problem Solving", credit: 3, type: "theory" },
                    { code: "100115P", name: "Swachha Bharat Mission", credit: 1, type: "practical" },
                    { code: "100113", name: "IT Workshop", credit: 2, type: "theory" },
                    { code: "100114", name: "Basic Electronics Engineering", credit: 3, type: "theory" },
                    { code: "100110P", name: "Engineering Physics Lab", credit: 1, type: "practical" },
                    { code: "100111P", name: "Programming for Problem Solving Lab", credit: 1, type: "practical" },
                    { code: "100113P", name: "IT Workshop Lab", credit: 1, type: "practical" },
                    { code: "100114P", name: "Basic Electronics Engineering Lab", credit: 1, type: "practical" }
                ],
                "2nd Semester": [
                    { code: "100215", name: "Engineering Chemistry", credit: 3, type: "theory" },
                    { code: "100202", name: "Engineering Mathematics-II", credit: 4, type: "theory" },
                    { code: "100216", name: "Communicative English", credit: 3, type: "theory" },
                    { code: "100220P", name: "Sports/Yoga/NCC/NSS", credit: 1, type: "practical" },
                    { code: "100218", name: "Python Programming", credit: 2, type: "theory" },
                    { code: "100219", name: "Introduction to Web Design", credit: 3, type: "theory" },
                    { code: "100215P", name: "Engineering Chemistry Lab", credit: 1, type: "practical" },
                    { code: "100216P", name: "Communicative English Lab", credit: 1, type: "practical" },
                    { code: "100218P", name: "Python Programming Lab", credit: 1, type: "practical" },
                    { code: "100219P", name: "Introduction to Web Design Lab", credit: 1, type: "practical" }
                ],
                "3rd Semester": [
                    { code: "100311", name: "MATHEMATICS-III (DIFFERENTIAL CALCULUS)", credit: 2, type: "theory" },
                    { code: "100313", name: "OBJECT ORIENTED PROGRAMMING USING C++", credit: 3, type: "theory" },
                    { code: "100314", name: "TECHNICAL WRITING", credit: 3, type: "theory" },
                    { code: "100314", name: "ANALOG ELECTRONIC CIRCUITS", credit: 3, type: "theory" },
                    { code: "100304", name: "DATA STRUCTURE & ALGORITHMS", credit: 3, type: "theory" },
                    { code: "100313P", name: "OBJECT ORIENTED PROGRAMMING USING C++ LAB", credit: 2, type: "practical" },
                    { code: "100399", name: "Internship", credit: 4, type: "special_100" },
                    { code: "100302P", name: "Analog Electronics Circuits Laboratory LAB", credit: 2, type: "practical" },
                    { code: "100304P", name: "DATA STRUCTURE & ALGORITHMS LAB", credit: 2, type: "practical" }
                ],
                "4th Semester": [
                    { code: "100403", name: "Digital Electronics", credit: 3, type: "theory" },
                    { code: "100404", name: "Discrete Mathematics", credit: 4, type: "theory" },
                    { code: "100407", name: "Human Resource Development and Organizational Behavior", credit: 3, type: "theory" },
                    { code: "105401", name: "Computer Organization & Architecture", credit: 3, type: "theory" },
                    { code: "105402", name: "Design & Analysis of Algorithms", credit: 3, type: "theory" },
                    { code: "105403", name: "Operating Systems", credit: 3, type: "theory" },
                    { code: "100403P", name: "Digital Electronics", credit: 2, type: "practical" },
                    { code: "105401P", name: "Computer Organization & Architecture", credit: 2, type: "practical" },
                    { code: "105402P", name: "Design & Analysis of Algorithms", credit: 2, type: "practical" },
                    { code: "105403P", name: "Operating Systems", credit: 2, type: "practical" },
                    { code: "100408", name: "MOOCs / SWAYAM / NPTEL Courses - 1", credit: 2, type: "special_100" }
                ],
                "5th Semester": [
                    { code: "100508", name: "Professional Skill Development", credit: 3, type: "theory" },
                    { code: "105501", name: "Artificial intelligence", credit: 3, type: "theory" },
                    { code: "105502", name: "Database Management Systems", credit: 3, type: "theory" },
                    { code: "105503", name: "Formal Language & Automata Theory", credit: 4, type: "theory" },
                    { code: "105504", name: "Software Engineering", credit: 3, type: "theory" },
                    { code: "105505", name: "Seminar", credit: 1, type: "practical" }, // <-- यह यहाँ 50 मार्क्स (30+20) के लिए अपडेट किया गया है।
                    { code: "100510", name: "Summer Entrepreneurship – II", credit: 6, type: "special_100" },
                    { code: "100511", name: "MOOCs / SWAYAM / NPTEL Courses 2", credit: 2, type: "special_100" },
                    { code: "105502P", name: "Database Management Systems", credit: 2, type: "practical" }
                ]
            },
            "Civil Engineering": {
                "1st Semester": [
                    { code: "100101", name: "Engineering Chemistry", credit: 3, type: "theory" },
                    { code: "100102", name: "Engineering Mathematics-I", credit: 4, type: "theory" },
                    { code: "100103", name: "Communicative English", credit: 3, type: "theory" },
                    { code: "100104", name: "Engineering Graphics and Design", credit: 1, type: "theory" },
                    { code: "100105", name: "Engineering Mechanics", credit: 4, type: "theory" },
                    { code: "100109P", name: "Sports/Yoga/NCC/NSS", credit: 1, type: "practical" },
                    { code: "100101P", name: "Engineering Chemistry Lab", credit: 1, type: "practical" },
                    { code: "100103P", name: "Communicative English Lab", credit: 1, type: "practical" },
                    { code: "100104P", name: "Engineering Graphics and Design Lab", credit: 2, type: "practical" }
                ],
                "2nd Semester": [
                    { code: "100201", name: "Engineering Physics", credit: 3, type: "theory" },
                    { code: "100202", name: "Engineering Mathematics-II", credit: 4, type: "theory" },
                    { code: "100203", name: "Programming for Problem Solving", credit: 3, type: "theory" },
                    { code: "100214P", name: "Swachha Bharat Mission", credit: 1, type: "practical" },
                    { code: "100210", name: "Building Material and Construction Techniques", credit: 2, type: "theory" },
                    { code: "100211", name: "Environmental Science and Sanitation", credit: 2, type: "theory" },
                    { code: "100212", name: "Elements of Civil Engineering", credit: 2, type: "theory" },
                    { code: "100201P", name: "Engineering Physics Lab", credit: 1, type: "practical" },
                    { code: "100203P", name: "Programming for Problem Solving Lab", credit: 1, type: "practical" },
                    { code: "100210P", name: "Building Material and Construction Techniques Lab", credit: 1, type: "practical" }
                ],
                "3rd Semester": [
                    { code: "100301", name: "BIOLOGY FOR ENGINEERS", credit: 2, type: "theory" },
                    { code: "100312", name: "MATHEMATICS-III (PDE, PROBABILITY AND STATISTICS)", credit: 2, type: "theory" },
                    { code: "101302", name: "BASIC ELECTRONICS", credit: 1, type: "theory" },
                    { code: "101303", name: "COMPUTER AIDED CIVIL ENGINEERING DRAWING", credit: 1, type: "theory" },
                    { code: "101304", name: "ENGINEERING MECHANICS", credit: 4, type: "theory" },
                    { code: "101305", name: "HUMANITIES-I(EFFECTIVE TECHNICAL COMMUNICATION)", credit: 3, type: "theory" },
                    { code: "101306", name: "INTRODUCTION TO CIVIL ENGINEERING", credit: 2, type: "theory" },
                    { code: "101308", name: "SURVEYING & GEOMATICS", credit: 2, type: "theory" },
                    { code: "100399", name: "Internship", credit: 4, type: "special_100" },
                    { code: "101302P", name: "BASIC ELECTRONICS", credit: 1, type: "practical" },
                    { code: "101303P", name: "COMPUTER AIDED CIVIL ENGINEERING DRAWING", credit: 1, type: "practical" },
                    { code: "101308P", name: "SURVEYING & GEOMATICS", credit: 1, type: "practical" }
                ],
                "4th Semester": [
                    { code: "101401", name: "Civil Engineering - Societal & Global Impact", credit: 2, type: "theory" },
                    { code: "101402", name: "Disaster Preparedness & Planning", credit: 2, type: "theory" },
                    { code: "101403", name: "Engineering Geology", credit: 2, type: "theory" },
                    { code: "101404", name: "Introduction to Fluid Mechanics", credit: 3, type: "theory" },
                    { code: "101405", name: "Introduction to Solid Mechanics", credit: 3, type: "theory" },
                    { code: "101406", name: "Materials, Testing & Evaluation", credit: 2, type: "theory" },
                    { code: "101407", name: "Mechanical Engineering", credit: 3, type: "theory" },
                    { code: "101408", name: "Structural Analysis", credit: 4, type: "theory" },
                    { code: "100408", name: "MOOCs / SWAYAM / NPTEL Courses - 1", credit: 2, type: "special_100" },
                    { code: "101403P", name: "Engineering Geology", credit: 1, type: "practical" },
                    { code: "101404P", name: "Introduction to Fluid Mechanics", credit: 1, type: "practical" },
                    { code: "101406P", name: "Materials, Testing & Evaluation", credit: 1, type: "practical" }
                ],
                "5th Semester": [
                    { code: "101501", name: "Analysis and Design of Concrete Structure", credit: 3, type: "theory" },
                    { code: "101502", name: "Environmental Engineering -I", credit: 3, type: "theory" },
                    { code: "101503", name: "Geotechnical Engineering -I", credit: 3, type: "theory" },
                    { code: "101504", name: "Hydraulic Engineering", credit: 2, type: "theory" },
                    { code: "101505", name: "Hydrology & Water Resources Engineering", credit: 2, type: "theory" },
                    { code: "101506", name: "Mechanics of Materials", credit: 3, type: "theory" },
                    { code: "101507", name: "Transportation Engineering", credit: 3, type: "theory" },
                    { code: "100510", name: "Summer Entrepreneurship – II", credit: 6, type: "special_100" },
                    { code: "100511", name: "MOOCs / SWAYAM / NPTEL Courses 2", credit: 2, type: "special_100" },
                    { code: "101502P", name: "Environmental Engineering -I", credit: 1, type: "practical" },
                    { code: "101503P", name: "Geotechnical Engineering -I", credit: 1, type: "practical" },
                    { code: "101504P", name: "Hydraulic Engineering", credit: 1, type: "practical" },
                    { code: "101505P", name: "Hydrology & Water Resources Engineering", credit: 1, type: "practical" },
                    { code: "101507P", name: "Transportation Engineering", credit: 1, type: "practical" }
                ]
            },
            "Chemical Engineering": {
                "1st Semester": [
                    { code: "100101", name: "Engineering Chemistry", credit: 3, type: "theory" },
                    { code: "100102", name: "Engineering Mathematics-I", credit: 4, type: "theory" },
                    { code: "100103", name: "Communicative English", credit: 3, type: "theory" },
                    { code: "100104", name: "Engineering Graphics and Design", credit: 1, type: "theory" },
                    { code: "100106", name: "Basic Electrical Engineering", credit: 3, type: "theory" },
                    { code: "100109P", name: "Sports/Yoga/NCC/NSS", credit: 1, type: "practical" },
                    { code: "100101P", name: "Engineering Chemistry Lab", credit: 1, type: "practical" },
                    { code: "100103P", name: "Communicative English Lab", credit: 1, type: "practical" },
                    { code: "100104P", name: "Engineering Graphics and Design Lab", credit: 2, type: "practical" },
                    { code: "100106P", name: "Basic Electrical Engineering Lab", credit: 1, type: "practical" }
                ],
                "2nd Semester": [
                    { code: "100201", name: "Engineering Physics", credit: 3, type: "theory" },
                    { code: "100202", name: "Engineering Mathematics-II", credit: 4, type: "theory" },
                    { code: "100203", name: "Programming for Problem Solving", credit: 3, type: "theory" },
                    { code: "100214P", name: "Swachha Bharat Mission", credit: 1, type: "practical" },
                    { code: "100206", name: "Workshop Practices", credit: 2, type: "theory" },
                    { code: "100213", name: "Introduction to Chemical Engineering", credit: 4, type: "theory" },
                    { code: "100201P", name: "Engineering Physics Lab", credit: 1, type: "practical" },
                    { code: "100203P", name: "Programming for Problem Solving Lab", credit: 1, type: "practical" },
                    { code: "100206P", name: "Workshop Practices Lab", credit: 1, type: "practical" }
                ],
                "3rd Semester": [
                    { code: "114301", name: "Introduction to Chemical Engineering", credit: 3, type: "theory" },
                    { code: "114302", name: "Process Calculation", credit: 3, type: "theory" },
                    { code: "114303", name: "Solid Fluid Operations", credit: 3, type: "theory" },
                    { code: "114304", name: "Physical & Organic Chemistry", credit: 3, type: "theory" },
                    { code: "114305", name: "Python programming", credit: 3, type: "theory" },
                    { code: "114306", name: "Maths – III", credit: 4, type: "theory" },
                    { code: "114303P", name: "Solid Fluid Operations Lab", credit: 1.5, type: "practical" },
                    { code: "114305P", name: "Python programming Lab", credit: 1.5, type: "practical" }
                ],
                "4th Semester": [
                    { code: "114401", name: "Chemical Process Technology", credit: 3, type: "theory" },
                    { code: "114402", name: "Chemical Engineering Materials", credit: 3, type: "theory" },
                    { code: "114403", name: "Chemical Engineering Thermodynamics", credit: 3, type: "theory" },
                    { code: "114404", name: "Industrial Fluid Flow Operations", credit: 3, type: "theory" },
                    { code: "114405", name: "Process Equipment Design and Drawing", credit: 3, type: "theory" },
                    { code: "114401P", name: "Chemical Process Technology Lab", credit: 2, type: "practical" },
                    { code: "114404P", name: "Industrial Fluid Flow Operation Lab", credit: 2, type: "practical" },
                    { code: "114405P", name: "Process Equipment Design and Drawing Lab", credit: 2, type: "practical" }
                ]
            },
            "Electrical & Electronics Engineering": {
                "1st Semester": [
                    { code: "100101", name: "Engineering Physics", credit: 3, type: "theory" },
                    { code: "100102", name: "Engineering Mathematics-I", credit: 4, type: "theory" },
                    { code: "100111", name: "Programming for Problem Solving", credit: 3, type: "theory" },
                    { code: "100112", name: "Workshop Practices", credit: 2, type: "theory" },
                    { code: "100106", name: "Basic Electrical Engineering", credit: 3, type: "theory" },
                    { code: "100115P", name: "Swachha Bharat Mission (SBM)", credit: 1, type: "practical" },
                    { code: "100101P", name: "Engineering Physics Lab", credit: 1, type: "practical" },
                    { code: "100112P", name: "Workshop Practices Lab", credit: 1, type: "practical" },
                    { code: "100106P", name: "Basic Electrical Engineering Lab", credit: 1, type: "practical" },
                    { code: "100111P", name: "Programming for Problem Solving Lab", credit: 1, type: "practical" }
                ],
                "2nd Semester": [
                    { code: "100215", name: "Engineering Chemistry", credit: 3, type: "theory" },
                    { code: "100202", name: "Engineering Mathematics-I", credit: 4, type: "theory" },
                    { code: "100216", name: "Communicative English", credit: 3, type: "theory" },
                    { code: "100220P", name: "Sports/Yoga/NCC/NSS", credit: 1, type: "practical" },
                    { code: "100209", name: "Basic Electronics", credit: 3, type: "theory" },
                    { code: "100217", name: "Engineering Graphics & Design", credit: 1, type: "theory" },
                    { code: "100215P", name: "Engineering Chemistry Lab", credit: 1, type: "practical" },
                    { code: "100216P", name: "Communicative English Lab", credit: 1, type: "practical" },
                    { code: "100209P", name: "Basic Electronics Lab", credit: 1, type: "practical" },
                    { code: "100217P", name: "Engineering Graphics & Design Lab", credit: 2, type: "practical" }
                ],
                "3rd Semester": [
                    { code: "100305", name: "DIGITAL ELECTRONICS", credit: 3, type: "theory" },
                    { code: "100306", name: "ELECTRICAL CIRCUIT ANALYSIS", credit: 4, type: "theory" },
                    { code: "100307", name: "ELECTRICAL MACHINES - I", credit: 3, type: "theory" },
                    { code: "100308", name: "ELECTROMAGNETIC FIELDS", credit: 4, type: "theory" },
                    { code: "100310", name: "ENGINEERING MECHANICS", credit: 4, type: "theory" },
                    { code: "100307P", name: "Electrical Machines Laboratory", credit: 1, type: "practical" },
                    { code: "100399", name: "Internship", credit: 4, type: "special_100" },
                    { code: "110301", name: "MOOCs / SWAYAM / NPTEL Courses 1", credit: 2, type: "special_100" }
                ],
                "4th Semester": [
                    { code: "100401", name: "Biology for Engineers", credit: 3, type: "theory" },
                    { code: "110401", name: "Analog Electronics", credit: 3, type: "theory" },
                    { code: "110402", name: "Electrical Machines – II", credit: 3, type: "theory" },
                    { code: "110403", name: "Industrial Economics & Foreign Trade", credit: 2, type: "theory" },
                    { code: "110404", name: "Mathematics–III (Probability and Statistics)", credit: 4, type: "theory" },
                    { code: "110405", name: "Microprocessors", credit: 3, type: "theory" },
                    { code: "110406", name: "Signals and Systems", credit: 3, type: "theory" },
                    { code: "110401P", name: "Analog Electronics", credit: 1, type: "practical" },
                    { code: "110402P", name: "Electrical Machines – II", credit: 1, type: "practical" },
                    { code: "110405P", name: "Microprocessors", credit: 1, type: "practical" }
                ],
                "5th Semester": [
                    { code: "100502", name: "Control Systems", credit: 3, type: "theory" },
                    { code: "100506", name: "Power Electronics", credit: 3, type: "theory" },
                    { code: "100507", name: "Power Systems–I (Apparatus and Modelling)", credit: 3, type: "theory" },
                    { code: "110501", name: "Analog & Digital Communication System", credit: 3, type: "theory" },
                    { code: "100502P", name: "Control Systems", credit: 1, type: "practical" },
                    { code: "100506P", name: "Power Electronics", credit: 1, type: "practical" },
                    { code: "100507P", name: "Power Systems–I (Apparatus and Modelling)", credit: 1, type: "practical" },
                    { code: "100510", name: "Summer Entrepreneurship – II", credit: 6, type: "special_100" },
                    { code: "100511", name: "MOOCs / SWAYAM / NPTEL Courses 2", credit: 2, type: "special_100" },
                    { code: "110501P", name: "Analog & Digital Communication System", credit: 1, type: "practical" },
                    { code: "110504", name: "Simulation Tools for Electrical & Electronics Engineering", credit: 1, type: "theory" }
                ]
            }
        };

        const branchSelect = document.getElementById('branchSelect');
        const semesterSelect = document.getElementById('semesterSelect');
        const subjectsContainer = document.getElementById('subjectsContainer');
        const calculateSGPABtn = document.getElementById('calculateSGPABtn');
        const downloadPdfBtn = document.getElementById('downloadPdfBtn');
        const resultContainer = document.getElementById('resultContainer');

        // Helper to convert marks to grade point for Theory subjects (70+30, 25 in End Sem fail)
        function getTheoryGradePoint(internalMarks, endSemMarks) {
            const totalMarks = internalMarks + endSemMarks;

            if (endSemMarks < 25) { // Fail condition based on University marks
                return 0; // Fail
            }

            if (totalMarks < 35) {
                return 0; // Fail
            } else if (totalMarks >= 90) {
                return 10; // A+
            } else if (totalMarks >= 80) {
                return 9;  // A
            } else if (totalMarks >= 70) {
                return 8;  // B
            } else if (totalMarks >= 60) {
                return 7;  // C
            } else if (totalMarks >= 50) {
                return 6;  // D
            } else if (totalMarks >= 35) {
                return 5;  // P (Pass)
            }
            return 0; // Should not reach here if logic is complete
        }

        // Helper to convert marks to grade point for Practical subjects (30+20 = 50 total)
        function getPracticalGradePoint(collegeMarks, universityMarks) {
            const totalMarks = collegeMarks + universityMarks;

            if (totalMarks < 20) { // Fail if total practical is less than 20
                return 0; // Fail
            } else if (totalMarks >= 45) {
                return 10; // A+
            } else if (totalMarks >= 40) {
                return 9;  // A
            } else if (totalMarks >= 35) {
                return 8;  // B
            } else if (totalMarks >= 30) {
                return 7;  // C
            } else if (totalMarks >= 25) {
                return 6;  // D
            } else if (totalMarks >= 20) {
                return 5;  // P (Pass)
            }
            return 0; // Should not reach here
        }

        // Helper for subjects like Internship and NPTEL which are 100 marks total
        function getSpecial100GradePoint(totalMarks) {
            if (totalMarks < 35) {
                return 0; // Fail
            } else if (totalMarks >= 90) {
                return 10; // A+
            } else if (totalMarks >= 80) {
                return 9;  // A
            } else if (totalMarks >= 70) {
                return 8;  // B
            } else if (totalMarks >= 60) {
                return 7;  // C
            } else if (totalMarks >= 50) {
                return 6;  // D
            } else if (totalMarks >= 35) {
                return 5;  // P (Pass)
            }
            return 0; // Should not reach here if logic is complete
        }

        function populateSemesters() {
            const selectedBranch = branchSelect.value;
            semesterSelect.innerHTML = '<option value="">-- Select Semester --</option>';
            semesterSelect.disabled = true;
            subjectsContainer.innerHTML = '<p class="placeholder-text">Please select your Branch and Semester to load subjects.</p>';
            calculateSGPABtn.disabled = true;
            downloadPdfBtn.disabled = true;
            resultContainer.textContent = '';

            if (selectedBranch) {
                const semesters = Object.keys(subjectsData[selectedBranch]);
                semesters.forEach(semester => {
                    const option = document.createElement('option');
                    option.value = semester;
                    option.textContent = semester;
                    semesterSelect.appendChild(option);
                });
                semesterSelect.disabled = false;
            }
        }

        function loadSubjects() {
            const selectedBranch = branchSelect.value;
            const selectedSemester = semesterSelect.value;
            subjectsContainer.innerHTML = '';
            resultContainer.textContent = '';
            calculateSGPABtn.disabled = true;
            downloadPdfBtn.disabled = true;

            if (selectedBranch && selectedSemester) {
                const subjects = subjectsData[selectedBranch][selectedSemester];
                if (subjects && subjects.length > 0) {
                    subjects.forEach(subject => {
                        const subjectItem = document.createElement('div');
                        subjectItem.classList.add('subject-item');
                        subjectItem.dataset.code = subject.code;
                        subjectItem.dataset.credit = subject.credit;
                        subjectItem.dataset.type = subject.type;

                        const subjectDetails = document.createElement('div');
                        subjectDetails.classList.add('subject-details');
                        subjectDetails.innerHTML = `<div class="name">${subject.code} - ${subject.name}</div><div class="credit">Credits: ${subject.credit}</div>`;
                        subjectItem.appendChild(subjectDetails);

                        const marksInputDiv = document.createElement('div');
                        marksInputDiv.classList.add('marks-input');

                        if (subject.type === 'theory') {
                            const internalInput = document.createElement('input');
                            internalInput.type = 'number';
                            internalInput.placeholder = 'Internal (30)';
                            internalInput.min = '0';
                            internalInput.max = '30';
                            internalInput.dataset.type = 'internal';
                            marksInputDiv.appendChild(internalInput);

                            const endSemInput = document.createElement('input');
                            endSemInput.type = 'number';
                            endSemInput.placeholder = 'End Sem (70)';
                            endSemInput.min = '0';
                            endSemInput.max = '70';
                            endSemInput.dataset.type = 'endsem';
                            marksInputDiv.appendChild(endSemInput);
                        } else if (subject.type === 'practical') {
                            const collegeInput = document.createElement('input');
                            collegeInput.type = 'number';
                            collegeInput.placeholder = 'College (30)';
                            collegeInput.min = '0';
                            collegeInput.max = '30';
                            collegeInput.dataset.type = 'college';
                            marksInputDiv.appendChild(collegeInput);

                            const universityInput = document.createElement('input');
                            universityInput.type = 'number';
                            universityInput.placeholder = 'University (20)';
                            universityInput.min = '0';
                            universityInput.max = '20';
                            universityInput.dataset.type = 'university';
                            marksInputDiv.appendChild(universityInput);
                        } else if (subject.type === 'special_100') {
                            const totalInput = document.createElement('input');
                            totalInput.type = 'number';
                            totalInput.placeholder = 'Total (100)';
                            totalInput.min = '0';
                            totalInput.max = '100';
                            totalInput.dataset.type = 'total';
                            marksInputDiv.appendChild(totalInput);
                        }
                        subjectItem.appendChild(marksInputDiv);
                        subjectsContainer.appendChild(subjectItem);
                    });
                    calculateSGPABtn.disabled = false;
                } else {
                    subjectsContainer.innerHTML = '<p class="placeholder-text">No subjects found for this selection.</p>';
                }
            } else {
                subjectsContainer.innerHTML = '<p class="placeholder-text">Please select your Branch and Semester to load subjects.</p>';
            }
        }

        function calculateSGPA() {
            let totalGradePoints = 0;
            let totalCredits = 0;
            let allMarksEntered = true;
            resultContainer.textContent = '';

            const subjectItems = subjectsContainer.querySelectorAll('.subject-item');
            const subjectResults = [];

            subjectItems.forEach(item => {
                const subjectNameFull = item.querySelector('.subject-details .name').textContent;
                const subjectCode = item.dataset.code;
                const credit = parseFloat(item.dataset.credit);
                const type = item.dataset.type;
                let gradePoint = 0;
                let marksEnteredForSubject = true;
                let totalMarksObtained = 0;

                if (type === 'theory') {
                    const internalInput = item.querySelector('input[data-type="internal"]');
                    const endSemInput = item.querySelector('input[data-type="endsem"]');
                    const internalMarks = internalInput ? parseInt(internalInput.value) : NaN;
                    const endSemMarks = endSemInput ? parseInt(endSemInput.value) : NaN;

                    if (isNaN(internalMarks) || isNaN(endSemMarks) || internalMarks < 0 || internalMarks > 30 || endSemMarks < 0 || endSemMarks > 70) {
                        allMarksEntered = false;
                        marksEnteredForSubject = false;
                    } else {
                        gradePoint = getTheoryGradePoint(internalMarks, endSemMarks);
                        totalMarksObtained = internalMarks + endSemMarks;
                    }
                } else if (type === 'practical') {
                    const collegeInput = item.querySelector('input[data-type="college"]');
                    const universityInput = item.querySelector('input[data-type="university"]');
                    const collegeMarks = collegeInput ? parseInt(collegeInput.value) : NaN;
                    const universityMarks = universityInput ? parseInt(universityInput.value) : NaN;

                    if (isNaN(collegeMarks) || isNaN(universityMarks) || collegeMarks < 0 || collegeMarks > 30 || universityMarks < 0 || universityMarks > 20) {
                        allMarksEntered = false;
                        marksEnteredForSubject = false;
                    } else {
                        gradePoint = getPracticalGradePoint(collegeMarks, universityMarks);
                        totalMarksObtained = collegeMarks + universityMarks;
                    }
                } else if (type === 'special_100') {
                    const totalInput = item.querySelector('input[data-type="total"]');
                    const totalMarks = totalInput ? parseInt(totalInput.value) : NaN;

                    if (isNaN(totalMarks) || totalMarks < 0 || totalMarks > 100) {
                        allMarksEntered = false;
                        marksEnteredForSubject = false;
                    } else {
                        gradePoint = getSpecial100GradePoint(totalMarks);
                        totalMarksObtained = totalMarks;
                    }
                }

                subjectResults.push({
                    name: subjectNameFull,
                    code: subjectCode,
                    credit: credit,
                    type: type,
                    gradePoint: gradePoint,
                    totalMarks: totalMarksObtained,
                    passed: gradePoint > 0, // A subject is passed if gradePoint is > 0
                    marksValid: marksEnteredForSubject
                });

                if (marksEnteredForSubject) {
                    totalGradePoints += gradePoint * credit;
                    totalCredits += credit;
                }
            });

            if (!allMarksEntered) {
                resultContainer.textContent = "Please enter valid marks for all subjects (0-30 for Internal/College, 0-70 for End Sem, 0-20 for University Practical, 0-100 for 100-mark subjects).";
                downloadPdfBtn.disabled = true;
                return;
            }

            const sgpa = totalCredits > 0 ? (totalGradePoints / totalCredits).toFixed(2) : '0.00';

            // Check for any failed subjects to mark overall SGPA as 'Fail'
            const hasFailedSubject = subjectResults.some(sub => !sub.passed);

            if (hasFailedSubject) {
                resultContainer.style.color = '#dc3545'; // Red color for fail
                resultContainer.textContent = `SGPA: FAIL (Due to one or more failed subjects)`;
                downloadPdfBtn.disabled = true; // Disable PDF download on failure
            } else {
                resultContainer.style.color = '#ff8c00'; // Orange color for pass
                resultContainer.textContent = `Calculated SGPA: ${sgpa}`;
                downloadPdfBtn.disabled = false; // Enable PDF download on pass
            }
        }


        // PDF Generation
        async function downloadPdf() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            const selectedBranch = branchSelect.value;
            const selectedSemester = semesterSelect.value;
            const sgpaResult = resultContainer.textContent;

            let yPos = 20;

            doc.setFontSize(22);
            doc.setTextColor(255, 140, 0); // Orange
            doc.text("SGPA Report Card", doc.internal.pageSize.width / 2, yPos, { align: "center" });
            yPos += 15;

            doc.setFontSize(12);
            doc.setTextColor(0, 0, 0); // Black for details

            // User Details (Hardcoded for now as per previous conversations)
            doc.text(`Branch: ${selectedBranch}`, 20, yPos);
            yPos += 7;
            doc.text(`Semester: ${selectedSemester}`, 20, yPos);
            yPos += 7;
            doc.text(`Name: Krishna Raj`, 20, yPos);
            yPos += 7;
            doc.text(`Batch: 2023-27`, 20, yPos);
            yPos += 7;
            doc.text(`College: Rashtrakavi Ramdhari Singh Dinkar College of Engineering`, 20, yPos);
            yPos += 15; // Space before subjects

            doc.setFontSize(14);
            doc.setTextColor(255, 140, 0); // Orange for section header
            doc.text("Subject-wise Performance:", 20, yPos);
            yPos += 10;

            doc.setFontSize(10);
            doc.setTextColor(0, 0, 0); // Black for subject details

            const subjectItems = subjectsContainer.querySelectorAll('.subject-item');
            subjectItems.forEach(item => {
                const subjectName = item.querySelector('.subject-details .name').textContent;
                const credit = parseFloat(item.dataset.credit);
                const type = item.dataset.type;

                let internalMarks = '';
                let endSemMarks = '';
                let collegeMarks = '';
                let universityMarks = '';
                let totalMarks = '';
                let obtainedMarks = '';

                if (type === 'theory') {
                    internalMarks = item.querySelector('input[data-type="internal"]').value;
                    endSemMarks = item.querySelector('input[data-type="endsem"]').value;
                    obtainedMarks = parseInt(internalMarks) + parseInt(endSemMarks);
                } else if (type === 'practical') {
                    collegeMarks = item.querySelector('input[data-type="college"]').value;
                    universityMarks = item.querySelector('input[data-type="university"]').value;
                    obtainedMarks = parseInt(collegeMarks) + parseInt(universityMarks);
                } else if (type === 'special_100') {
                    totalMarks = item.querySelector('input[data-type="total"]').value;
                    obtainedMarks = parseInt(totalMarks);
                }

                let gradePoint = 0;
                if (type === 'theory') {
                    gradePoint = getTheoryGradePoint(parseInt(internalMarks), parseInt(endSemMarks));
                } else if (type === 'practical') {
                    gradePoint = getPracticalGradePoint(parseInt(collegeMarks), parseInt(universityMarks));
                } else if (type === 'special_100') {
                    gradePoint = getSpecial100GradePoint(parseInt(totalMarks));
                }

                const grade = getGradeFromGradePoint(gradePoint);
                const status = gradePoint > 0 ? 'PASS' : 'FAIL';

                let marksDisplay = '';
                if (type === 'theory') {
                    marksDisplay = `(Internal: ${internalMarks}, End Sem: ${endSemMarks})`;
                } else if (type === 'practical') {
                    marksDisplay = `(College: ${collegeMarks}, University: ${universityMarks})`;
                } else if (type === 'special_100') {
                    marksDisplay = `(Total: ${totalMarks})`;
                }

                if (yPos + 10 > doc.internal.pageSize.height - 20) { // Check if new page is needed
                    doc.addPage();
                    yPos = 20;
                }

                doc.text(`${subjectName} - Credits: ${credit}, Obtained Marks: ${obtainedMarks} ${marksDisplay}, Grade: ${grade}, Status: ${status}`, 20, yPos);
                yPos += 7;
            });

            yPos += 10;
            doc.setFontSize(16);
            doc.setTextColor(255, 140, 0); // Orange for final SGPA
            if (sgpaResult.includes("FAIL")) {
                doc.setTextColor(220, 53, 69); // Red for fail SGPA
            }
            doc.text(sgpaResult, 20, yPos);
            yPos += 10;


            // Footer for PDF
            doc.setFontSize(8);
            doc.setTextColor(150, 150, 150); // Grey
            if (yPos + 10 > doc.internal.pageSize.height - 10) { // Check if new page is needed for footer
                doc.addPage();
                yPos = 20;
            }
            doc.text(`Report generated on ${new Date().toLocaleDateString()} at ${new Date().toLocaleTimeString()}`, 20, doc.internal.pageSize.height - 10);
            doc.text(`Developed by Krishna Raj`, doc.internal.pageSize.width - 20, doc.internal.pageSize.height - 10, { align: "right" });


            doc.save("SGPA_Report.pdf");
        }

        // Helper to convert grade point back to grade letter for PDF
        function getGradeFromGradePoint(gp) {
            if (gp === 10) return 'A+';
            if (gp === 9) return 'A';
            if (gp === 8) return 'B';
            if (gp === 7) return 'C';
            if (gp === 6) return 'D';
            if (gp === 5) return 'P';
            return 'F';
        }

        // Event Listeners
        branchSelect.addEventListener('change', populateSemesters);
        semesterSelect.addEventListener('change', loadSubjects);
        calculateSGPABtn.addEventListener('click', calculateSGPA);
        downloadPdfBtn.addEventListener('click', downloadPdf);

        // Initial load
        populateSemesters();
    </script>
</body>
</html>
