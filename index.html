import React, { useState } from "react";
import { Card, CardContent } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";

const gradePoint = (univ, college, isTheory) => {
  if (isTheory) {
    const total = univ + college;
    if (univ < 25 || total < 35) return 0;
    if (total >= 90) return 10;
    if (total >= 80) return 9;
    if (total >= 70) return 8;
    if (total >= 60) return 7;
    if (total >= 50) return 6;
    if (total >= 35) return 5;
  } else {
    const total = univ + college;
    if (total < 20) return 0;
    if (total >= 45) return 10;
    if (total >= 40) return 9;
    if (total >= 35) return 8;
    if (total >= 30) return 7;
    if (total >= 25) return 6;
    if (total >= 20) return 5;
  }
  return 0;
};

const SGPA_Calculator = () => {
  const [subjects, setSubjects] = useState([
    // Sample subjects, replace dynamically as per branch/semester
    { code: "100301", name: "Biology", credit: 3, isTheory: true, univ: 0, college: 0 },
    { code: "100309P", name: "Engg Mechanics Lab", credit: 1, isTheory: false, univ: 0, college: 0 },
  ]);

  const handleChange = (index, field, value) => {
    const newSubjects = [...subjects];
    newSubjects[index][field] = parseInt(value) || 0;
    setSubjects(newSubjects);
  };

  const calculateSGPA = () => {
    let totalCredit = 0;
    let totalPoints = 0;

    subjects.forEach((subj) => {
      const gp = gradePoint(subj.univ, subj.college, subj.isTheory);
      totalPoints += gp * subj.credit;
      totalCredit += subj.credit;
    });

    return (totalPoints / totalCredit).toFixed(2);
  };

  return (
    <div className="bg-black text-orange-400 min-h-screen p-6">
      <h1 className="text-2xl font-bold mb-4">BEU Semester Result Prediction</h1>
      {subjects.map((subj, index) => (
        <Card key={index} className="mb-4 bg-gray-900">
          <CardContent className="p-4">
            <p className="mb-2 font-semibold">
              {subj.code} - {subj.name} ({subj.credit} Credits)
            </p>
            <div className="flex gap-4">
              <Input
                placeholder="University Marks"
                type="number"
                onChange={(e) => handleChange(index, "univ", e.target.value)}
                className="w-40"
              />
              <Input
                placeholder="College Marks"
                type="number"
                onChange={(e) => handleChange(index, "college", e.target.value)}
                className="w-40"
              />
            </div>
          </CardContent>
        </Card>
      ))}
      <Button onClick={() => alert(`Your SGPA is: ${calculateSGPA()}`)}>Calculate SGPA</Button>
    </div>
  );
};

export default SGPA_Calculator;
